;
; drawcircle.s -- Bresenham for circles
;

	.export	drawCircle

	.import	_gfxinstalled
	.import	_nogfx
	.import	_setPixelNoCheck

	.code
	.align	4

	; drawCircle(x0: int, y0: int, radius: int, color: int)
drawCircle:
	ldw	$8,$0,_gfxinstalled
	beq	$8,$0,_nogfx
drawCircleNoCheck:
	sub	$29,$29,40
	stw	$25,$29,16
	add	$25,$29,40
	stw	$31,$25,-28
	add	$8,$25,-4
	add	$9,$0,0
	stw	$9,$8,0
	add	$8,$25,-8
	add	$9,$25,8
	ldw	$9,$9,0
	stw	$9,$8,0
	add	$8,$25,-12
	add	$9,$0,1
	add	$10,$25,8
	ldw	$10,$10,0
	sub	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,-16
	add	$9,$0,3
	stw	$9,$8,0
	add	$8,$25,-20
	add	$9,$0,0
	add	$10,$0,2
	sub	$9,$9,$10
	add	$10,$25,8
	ldw	$10,$10,0
	mul	$9,$9,$10
	add	$10,$0,5
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,-4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	beq	$8,$9,drawCircle0
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
drawCircle0:
drawCircle1:
	add	$8,$25,-8
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	ble	$8,$9,drawCircle2
	add	$8,$25,-12
	ldw	$8,$8,0
	add	$9,$0,0
	bge	$8,$9,drawCircle3
	add	$8,$25,-12
	add	$9,$25,-12
	ldw	$9,$9,0
	add	$10,$25,-16
	ldw	$10,$10,0
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,-16
	add	$9,$25,-16
	ldw	$9,$9,0
	add	$10,$0,2
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,-20
	add	$9,$25,-20
	ldw	$9,$9,0
	add	$10,$0,2
	add	$9,$9,$10
	stw	$9,$8,0
	j	drawCircle4
drawCircle3:
	add	$8,$25,-12
	add	$9,$25,-12
	ldw	$9,$9,0
	add	$10,$25,-20
	ldw	$10,$10,0
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,-16
	add	$9,$25,-16
	ldw	$9,$9,0
	add	$10,$0,2
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,-20
	add	$9,$25,-20
	ldw	$9,$9,0
	add	$10,$0,4
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,-8
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$10,$0,1
	sub	$9,$9,$10
	stw	$9,$8,0
drawCircle4:
	add	$8,$25,-4
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$10,$0,1
	add	$9,$9,$10
	stw	$9,$8,0
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,-4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	beq	$8,$9,drawCircle5
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
	add	$8,$25,0
	ldw	$8,$8,0
	add	$9,$25,-4
	ldw	$9,$9,0
	sub	$8,$8,$9
	stw	$8,$29,0
	add	$8,$25,4
	ldw	$8,$8,0
	add	$9,$25,-8
	ldw	$9,$9,0
	add	$8,$8,$9
	stw	$8,$29,4
	add	$8,$25,12
	ldw	$8,$8,0
	stw	$8,$29,8
	jal	_setPixelNoCheck
drawCircle5:
	j	drawCircle1
drawCircle2:
	ldw	$31,$25,-28
	ldw	$25,$29,16
	add	$29,$29,40
	jr	$31
